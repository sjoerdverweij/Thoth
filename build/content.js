var g,f,b,v,A,E;const t=chrome.storage.local.get().then(t=>{f=t.assumeImperial,b=t.toImperial,v=t.addOtherSystem,A=t.highlight,E=t.showPopup,g=t.units;for(var e=document.querySelectorAll("h1, h2, h3, h4, h5, p, li, td, caption, span"),n=0;n<e.length;n++){for(var o=e[n],a=o.innerHTML,l=0,h=!1;l<a.length;){if("<"==a[l])for(;l<a.length&&">"!=a[l];)l++;for(;l<a.length&&(a[l]<"0"||"9"<a[l]);)l++;if(l<a.length)if(0!=l&&("A"<=a[l-1]&&a[l-1]<="Z"||"a"<=a[l-1]&&a[l-1]<="z"))for(;l<a.length&&"0"<=a[l]&&a[l]<="9";)l++;else{for(var i=l;l<a.length&&("0"<=a[l]&&a[l]<="9"||"."==a[l]||","==a[l]);)l++;if(l<a.length){var r=a.substring(i,l);if(!r.endsWith(".")&&!r.endsWith(",")&&"/"!=a[l]&&":"!=a[l]){var s=l;for(" "!=a[l]&&"-"!=a[l]||(s++,l++);l<a.length&&("'"==a[l]||'"'==a[l]||"a"<=a[l]&&a[l]<="z"||"A"<=a[l]&&a[l]<="Z"||"<"==a[l]||">"==a[l]);)l++;var c=a.substring(s,l),u=l;if(l<a.length&&" "==a[l])for(l++;l<a.length&&("a"<=a[l]&&a[l]<="z"||"A"<=a[l]&&a[l]<="Z");)l++;var p,m,s=a.substring(s,l),d=l;0<c.length&&(s=g[s],d=d,s||(s=g[c],d=u),s)&&(c=(r=f?r.replace(",",""):r.replace(".","").replace(",",".")).lastIndexOf("."),u=c<0?0:r.length-c-1,c=(+parseFloat(r)-s.ctba)/s.ctb-s.ctbb,r=c>=s.coi?g[s.pih]:g[s.pil],p=c>=s.com?g[s.pmh]:g[s.pml],m=(b?r:p).nf,r=L(c,r,m,s,u),p=L(c,p,m,s,u),m=b?r:p,v&&(m+=" ("+(b?p:r)+")"),u="",E&&(u=" onclick=\"showThothPopup(event, this, '"+a.substring(i,d)+"', '"+s.c+"', "+c+');"'),m="<span"+(A?' class="thoth"':"")+u+">"+m+"</span>",a=a.substring(0,i)+m+a.substring(d),l=i+m.length,h=!0)}}}}h&&(o.innerHTML=a)}t=document.createElement("script");t.src=chrome.runtime.getURL("thoth-popup.js"),t.onload=function(){this.remove()},(document.head||document.documentElement).appendChild(t),(t=document.createElement("div")).innerHTML='<span id="thoth-original">&nbsp;</span><br /><nav class="thoth-all-units-list-nav"><ul id="thoth-all-units" class="thoth-all-units-nav-ul"></ul></nav>',t.id="thoth-popup",t.className="thoth-popup",document.documentElement.appendChild(t),document.documentElement.setAttribute("onclick","hideThothPopup();"+(document.documentElement.getAttribute("onclick")||""))});function L(t,e,n,o,a){var t=(+t+e.ctbb)*e.ctb+e.ctba,l=t>=e.cod?e.hd:e.ld,o=(e.ps==o.ps&&(l=a),new Intl.NumberFormat(n,{maximumFractionDigits:l}).format(t)+e.ps);return o}!async function(){await t,chrome.storage.local.onChanged.addListener(function(t,e){location.reload()})}();