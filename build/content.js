var d,f,b,v,A,E;const t=chrome.storage.local.get().then(t=>{f=t.assumeImperial,b=t.toImperial,v=t.addOtherSystem,A=t.highlight,E=t.showPopup,d=t.units;for(var n=document.querySelectorAll("h1, h2, h3, h4, h5, p, li, td, caption, span"),e=0;e<n.length;e++){for(var o=n[e],r=o.innerHTML,s=0,i=!1;s<r.length;){for(;s<r.length&&(r[s]<"0"||"9"<r[s])&&"<"!=r[s];)s++;if(s<r.length&&"<"==r[s])s=function t(n,e){e++;const o=e;if("!"==n[e]){for(;e<n.length&&">"!=n[e];)e++;return++e}e=w(n,e);const r=n.substring(o,e);L("tagName: %s, p: %d, html: %s",r,e,n);for(;e<n.length&&">"!=n[e];){if("'"==n[e]||'"'==n[e]){const l=n[e];for(e++;e<n.length&&n[e]!=l;)"\\"==n[e]&&n[e+1]==l&&e++,e++}e++}e++;if("/"==n[e-2])return e;for(;e<n.length&&("<"!=n[e]||"/"!=n[e+1]);)"<"==n[e]&&"/"!=n[e+1]?e=t(n,e):e++;e+=2;const s=e;e=w(n,e);const i=n.substring(s,e);i!=r&&L("Tag mismatch, we've got a bug! Open tag is "+r+", close tag is "+i+", content is "+n.substring(o,e));e++;return e}(r,s);else if(s<r.length)if(0!=s&&("A"<=r[s-1]&&r[s-1]<="Z"||"a"<=r[s-1]&&r[s-1]<="z"))for(;s<r.length&&"0"<=r[s]&&r[s]<="9";)s++;else{for(var l=s;s<r.length&&("0"<=r[s]&&r[s]<="9"||"."==r[s]||","==r[s]);)s++;if(s<r.length){var a=r.substring(l,s);if(!a.endsWith(".")&&!a.endsWith(",")&&"/"!=r[s]&&":"!=r[s]){var c=s;for(" "!=r[s]&&"-"!=r[s]||(c++,s++);s<r.length&&("'"==r[s]||'"'==r[s]||"a"<=r[s]&&r[s]<="z"||"A"<=r[s]&&r[s]<="Z"||"<"==r[s]||">"==r[s]||"\\"==r[s]);)s++;var h=r.substring(c,s),u=s,c=(s<r.length&&" "==r[s]&&(s=w(r,++s)),r.substring(c,s)),g=s;if(0<h.length){var p,m,c=d[c];if(c||(c=d[h],g=u),s<r.length-2&&" "==r[s-1]&&"("==r[s]&&"0"<=r[s+1]&&r[s+1]<="9"){for(s+=2;s<r.length&&")"!=r[s];)s++;g=++s}c&&(h=(a=f?a.replace(",",""):a.replace(".","").replace(",",".")).lastIndexOf("."),u=h<0?0:a.length-h-1,h=(+parseFloat(a)-c.ctba)/c.ctb-c.ctbb,a=h>=c.coi?d[c.pih]:d[c.pil],p=h>=c.com?d[c.pmh]:d[c.pml],m=(b?a:p).nf,a=T(h,a,m,c,u),p=T(h,p,m,c,u),m=b?a:p,v&&(m+=" ("+(b?p:a)+")"),u="",E&&(u=" onclick=\"showThothPopup(event, this, '"+r.substring(l,g)+"', '"+c.c+"', "+h+');"'),m="<span"+(A?' class="thoth"':"")+u+">"+m+"</span>",r=r.substring(0,l)+m+r.substring(g),s=l+m.length,i=!0)}}}}}i&&(o.innerHTML=r)}t=document.createElement("script");t.src=chrome.runtime.getURL("thoth-popup.js"),t.onload=function(){this.remove()},(document.head||document.documentElement).appendChild(t),(t=document.createElement("div")).innerHTML='<span id="thoth-original">&nbsp;</span><br /><nav class="thoth-all-units-list-nav"></ul></nav>',t.id="thoth-popup",t.className="thoth-popup",document.documentElement.appendChild(t),document.documentElement.setAttribute("onclick","hideThothPopup();"+(document.documentElement.getAttribute("onclick")||""))});function T(t,n,e,o,r){var t=(+t+n.ctbb)*n.ctb+n.ctba,s=t>=n.cod?n.hd:n.ld,o=(n.ps==o.ps&&(s=r),new Intl.NumberFormat(e,{maximumFractionDigits:s}).format(t)+n.ps);return o}function w(t,n){for(;n<t.length&&("a"<=t[n]&&t[n]<="z"||"A"<=t[n]&&t[n]<="Z");)n++;return n}function L(...t){console.log(...t)}!async function(){await t,chrome.storage.local.onChanged.addListener(function(t,n){location.reload()})}();